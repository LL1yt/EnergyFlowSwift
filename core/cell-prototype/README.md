# Cell Prototype - –ü—Ä–æ—Ç–æ—Ç–∏–ø –ö–ª–µ—Ç–∫–∏

## üß¨ –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**Cell Prototype** - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –æ–¥–∏–Ω "—É–º–Ω—ã–π –±–ª–æ–∫" (–º–∏–Ω–∏-–Ω–µ–π—Ä–æ—Å–µ—Ç—å), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ç–∏—Ä–∞–∂–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞–∂–¥—É—é –∫–ª–µ—Ç–∫—É 3D —Ä–µ—à–µ—Ç–∫–∏.

**–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–æ–≥–∏—è**: –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –î–ù–ö - –æ–¥–∏–Ω –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –±—É–¥–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–∞—è –∫–ª–µ—Ç–∫–∞ –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ. –ù–∞—à Cell Prototype - —ç—Ç–æ "–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥" –¥–ª—è –≤—Å–µ—Ö –∫–ª–µ—Ç–æ–∫ –≤ –Ω–∞—à–µ–π 3D –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Ç–∫–∞–Ω–∏.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–ª–µ—Ç–∫–∞:

1. **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—ã**: —Å–∏–≥–Ω–∞–ª—ã –æ—Ç —Å–æ—Å–µ–¥–µ–π + —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–æ—à–ª–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤–Ω–µ—à–Ω–∏–π –≤—Ö–æ–¥
2. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —á–µ—Ä–µ–∑ —Å–≤–æ—é –º–∏–Ω–∏-–Ω–µ–π—Ä–æ—Å–µ—Ç—å
3. **–í—ã–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤—ã—Ö–æ–¥ –¥–ª—è —Å–æ—Å–µ–¥–µ–π

### –ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:

üîë **–í–°–ï –∫–ª–µ—Ç–∫–∏ –≤ —Ä–µ—à–µ—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –û–î–ò–ù–ê–ö–û–í–´–ï –≤–µ—Å–∞!** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –æ–±—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –û–î–ò–ù –ø—Ä–æ—Ç–æ—Ç–∏–ø, –∞ –Ω–µ –º–∏–ª–ª–∏–æ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –í—Ö–æ–¥–æ–≤ –∏ –í—ã—Ö–æ–¥–æ–≤

```
–í–•–û–î–´ –∫–ª–µ—Ç–∫–∏:
‚îú‚îÄ‚îÄ –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Å–µ–¥–µ–π (6 —Å–æ—Å–µ–¥–µ–π √ó state_size)
‚îú‚îÄ‚îÄ –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–æ—à–ª–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (state_size)
‚îî‚îÄ‚îÄ –í–Ω–µ—à–Ω–∏–π –≤—Ö–æ–¥ (external_input_size, –µ—Å–ª–∏ –µ—Å—Ç—å)

–û–ë–†–ê–ë–û–¢–ö–ê:
‚îú‚îÄ‚îÄ –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–æ–≤
‚îú‚îÄ‚îÄ –ü—Ä–æ–ø—É—Å–∫ —á–µ—Ä–µ–∑ –º–∏–Ω–∏-–Ω–µ–π—Ä–æ—Å–µ—Ç—å
‚îî‚îÄ‚îÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (tanh –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)

–í–´–•–û–î–´ –∫–ª–µ—Ç–∫–∏:
‚îú‚îÄ‚îÄ –ù–æ–≤–æ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (state_size)
‚îî‚îÄ‚îÄ –í—ã—Ö–æ–¥ –¥–ª—è —Å–æ—Å–µ–¥–µ–π (output_size)
```

## üî¨ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è (–¥–ª—è —Å—Ç–∞—Ä—Ç–∞):

```python
class CellPrototype(nn.Module):
    """
    –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –∫–ª–µ—Ç–∫–∏
    –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–æ–≥–∏—è: –û–¥–∏–Ω —Ç–∏–ø –Ω–µ–π—Ä–æ–Ω–∞ —Å –±–∞–∑–æ–≤—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
    """
    def __init__(self, input_size, state_size):
        # input_size = neighbor_signals + own_state + external_input
        # state_size = —Ä–∞–∑–º–µ—Ä –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–µ—Ç–∫–∏
        self.processor = nn.Sequential(
            nn.Linear(input_size, state_size),
            nn.Tanh()  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã—Ö–æ–¥—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
        )

    def forward(self, combined_input):
        new_state = self.processor(combined_input)
        return new_state
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è (–ø–æ–∑–∂–µ):

- –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤
- Skip connections
- Attention –º–µ–∂–¥—É —Å–æ—Å–µ–¥—è–º–∏
- –†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–π

## üßÆ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–ü—Ä–æ—Å—Ç—ã–º–∏ –°–ª–æ–≤–∞–º–∏)

### –®–∞–≥ 1: –°–±–æ—Ä –≤—Ö–æ–¥–æ–≤

```
total_input = [neighbor_1, neighbor_2, ..., neighbor_6, own_past_state, external]
```

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞

```
new_state = tanh(W √ó total_input + b)
```

–ì–¥–µ:

- `W` - –≤–µ—Å–∞ (–æ–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
- `b` - —Å–º–µ—â–µ–Ω–∏—è
- `tanh` - —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (-1 –¥–æ +1)

### –®–∞–≥ 3: –ü–µ—Ä–µ–¥–∞—á–∞

```
output_to_neighbors = new_state  # –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `config/cell_prototype.yaml`:

```yaml
cell_prototype:
  input_size: 12 # 6 —Å–æ—Å–µ–¥–µ–π √ó 2 + own_state
  state_size: 8 # –†–∞–∑–º–µ—Ä –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  output_size: 8 # –ß—Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º —Å–æ—Å–µ–¥—è–º

  architecture:
    layers: 1 # –ù–∞—á–∏–Ω–∞–µ–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ
    activation: "tanh" # –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    use_bias: true
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

```python
# –°–æ–∑–¥–∞–µ–º –∫–ª–µ—Ç–∫—É
cell = CellPrototype(input_size=12, state_size=8)

# –ü–æ–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –≤—Ö–æ–¥—ã
dummy_input = torch.randn(1, 12)
output = cell(dummy_input)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã
assert output.shape == (1, 8)
print("‚úÖ –ö–ª–µ—Ç–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!")
```

### –¢–µ—Å—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:

```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã—Ö–æ–¥—ã –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö
outputs = []
for _ in range(100):
    random_input = torch.randn(1, 12)
    output = cell(random_input)
    outputs.append(output.max().item())

max_output = max(outputs)
assert max_output <= 1.0  # tanh –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ [-1, 1]
```

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:

- **–í–µ—Å–∞ –∫–ª–µ—Ç–∫–∏** –∫–∞–∫ heatmap
- **–ê–∫—Ç–∏–≤–∞—Ü–∏—é –∫–ª–µ—Ç–∫–∏** –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–æ–≤** –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö
- **–≠–≤–æ–ª—é—Ü–∏—é –≤–µ—Å–æ–≤** –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è

## üîó –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ—Ç:

- `utils/config-manager` - –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `utils/math-helpers` - –¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:

- `lattice-3d` - –∫–∞–∫ –±–∞–∑–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ä–µ—à–µ—Ç–∫–∏
- `signal-propagation` - –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- `training-loop` - –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –≤–µ—Å–æ–≤

## üìà –ü–ª–∞–Ω –†–∞–∑–≤–∏—Ç–∏—è

### –§–∞–∑–∞ 1 (MVP):

- [x] –ü—Ä–æ—Å—Ç–µ–π—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (1 —Å–ª–æ–π + tanh)
- [ ] –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML

### –§–∞–∑–∞ 2 (–£–ª—É—á—à–µ–Ω–∏—è):

- [ ] –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –†–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- [ ] Skip connections

### –§–∞–∑–∞ 3 (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏):

- [ ] Attention –º–µ–∂–¥—É —Å–æ—Å–µ–¥—è–º–∏
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –∫–ª–µ—Ç–æ–∫

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ú–æ–º–µ–Ω—Ç—ã

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:

- –ò—Å–ø–æ–ª—å–∑—É–µ–º `tanh` –≤–º–µ—Å—Ç–æ `ReLU` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—ã—Ö–æ–¥–æ–≤
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ—Å–∞ —Å –º–∞–ª–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è

### –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:

- –í—Å–µ –∫–ª–µ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω–∏ –≤–µ—Å–∞ (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
- –í—ã—á–∏—Å–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å –Ω–∞ GPU
- –ü–∞–º—è—Ç—å —Ä–∞—Å—Ç–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑–º–µ—Ä–æ–º –æ–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏, –∞ –Ω–µ –≤—Å–µ–π —Ä–µ—à–µ—Ç–∫–∏

## üêõ –¢–∏–ø–∏—á–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã

### –í–∑—Ä—ã–≤–∞—é—â–∏–µ—Å—è –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã:

**–°–∏–º–ø—Ç–æ–º—ã**: –ü–æ—Ç–µ—Ä–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è NaN –∏–ª–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏
**–†–µ—à–µ–Ω–∏–µ**: Gradient clipping, –º–µ–Ω—å—à–∏–π learning rate

### –ó–∞—Ç—É—Ö–∞—é—â–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã:

**–°–∏–º–ø—Ç–æ–º—ã**: –ü–æ—Ç–µ—Ä–∏ –Ω–µ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: Skip connections, –¥—Ä—É–≥–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

### –ù–µ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:

**–°–∏–º–ø—Ç–æ–º—ã**: –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–µ—Ç–æ–∫ —Ä–∞—Å—Ç—É—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è (tanh), –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

---

**–ü–æ–º–Ω–∏—Ç–µ**: –ö–ª–µ—Ç–∫–∞ - —ç—Ç–æ —Å–µ—Ä–¥—Ü–µ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã. –ï—Å–ª–∏ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ, –≤—Å—è —Ä–µ—à–µ—Ç–∫–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ö–æ—Ä–æ—à–æ!
