graph TD
    subgraph "Stage 2.1: DIALOGUE TRAINING FUNCTIONAL"
        DT[Dialogue Training Pipeline]
        RT[run_dialogue_training.py]
        QA[Qâ†’A Transformation]
        
        DT --> RT
        RT --> QA
        QA --> RES[Training Results]
    end
    
    subgraph "EMBEDDING TRAINER MODULE v2.1.0"
        CT[CubeTrainer]
        TC[TrainingConfig]
        EM[EmbeddingMetrics]
        
        subgraph "DATASET SYSTEM"
            AD[AutoencoderDataset]
            DD[DialogueDataset]
            DC[DatasetConfig]
            
            CTD[create_text_dataset]
            CFD[create_file_dataset]
            CDD[create_dialogue_dataset]
        end
        
        subgraph "CORE INTEGRATION"
            EP[EmbeddingProcessor]
            ER[EmbeddingReshaper]
            EL[EmbeddingLoader]
        end
    end
    
    subgraph "TRAINING MODES"
        AUTO[Autoencoder Mode]
        DIAL[Dialogue Mode]
        MIXED[Mixed Mode]
    end
    
    subgraph "TEACHER LLM ARCHITECTURE"
        TLM[Teacher LLM]
        QE[Question Embedding]
        AE[Answer Embedding]
        
        TLM --> QE
        TLM --> AE
        QE --> CUBE[3D Cubic Core]
        CUBE --> AE
    end
    
    %% Main connections
    CT --> EP
    CT --> ER
    CT --> TC
    CT --> EM
    
    AD --> EL
    DD --> EL
    DD --> TLM
    
    CTD --> AD
    CFD --> AD
    CDD --> DD
    
    CT --> AUTO
    CT --> DIAL
    CT --> MIXED
    
    %% Stage 2.1 connections
    DD --> DT
    CT --> DT
    DIAL --> QA
    
    %% Styling
    classDef newFeature fill:#90EE90
    classDef functional fill:#FFD700
    classDef core fill:#87CEEB
    
    class DT,RT,QA,RES newFeature
    class DD,CDD,DIAL functional
    class CT,EP,ER core 