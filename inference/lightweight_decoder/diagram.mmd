graph TB
    %% ðŸŽ‰ STAGE 1 COMPLETE - PRODUCTION-READY ARCHITECTURE
    
    subgraph "INPUT LAYER"
        A[Input Embedding<br/>768D Vector] --> B{DecodingConfig<br/>Validation}
        B --> C[PhraseBankDecoder<br/>ðŸŽ‰ PRODUCTION-READY]
    end
    
    subgraph "CORE DECODER ARCHITECTURE"
        C --> D[Configuration Manager<br/>âœ… Save/Load Config]
        C --> E[Pattern Cache<br/>ðŸ’¾ LRU Caching 25-50%]
        C --> F[Error Handler<br/>ðŸ›¡ï¸ 100% Fallback Coverage]
        C --> G[Performance Monitor<br/>ðŸ“Š Real-time Analytics]
        
        D --> H[PhraseBank<br/>ðŸ“š Phrase Storage & Search]
        H --> I[Similarity Search<br/>ðŸ” k=10 candidates]
        I --> J[Context Analyzer<br/>ðŸ§  Context-aware Selection]
    end
    
    subgraph "ASSEMBLY STRATEGIES"
        J --> K{Assembly Method}
        K --> L[Weighted Assembly<br/>ðŸ“ Similarity-based]
        K --> M[Greedy Assembly<br/>âš¡ Best-first]
        K --> N[Beam Search<br/>ðŸ”¬ Multi-candidate]
        K --> O[Context-aware<br/>ðŸŽ¯ Intelligent Selection]
    end
    
    subgraph "POST-PROCESSING LAYER"
        L --> P[Text Assembler<br/>ðŸ”§ Multiple Strategies]
        M --> P
        N --> P
        O --> P
        
        P --> Q[Text Post-processor<br/>âœ¨ Grammar Enhancement]
        Q --> R[Quality Assessor<br/>ðŸ“ Confidence Scoring]
    end
    
    subgraph "OUTPUT & MONITORING"
        R --> S[Decoded Text<br/>Output]
        R --> T[Quality Metrics<br/>Confidence, Similarity]
        
        G --> U[Performance Statistics<br/>Cache hits, Timing]
        F --> V[Error Statistics<br/>Types, Recovery rates]
        E --> W[Cache Analytics<br/>Hit rates, Efficiency]
    end
    
    subgraph "PRODUCTION FEATURES"
        X[Health Monitoring<br/>ðŸ¥ Component Status] --> C
        Y[Session Management<br/>ðŸ”„ Context Tracking] --> C
        Z[Batch Processing<br/>ðŸ“¦ Multiple Inputs] --> C
        AA[Production Optimizer<br/>ðŸš€ Auto-tuning] --> C
    end
    
    %% Module Integration Flows
    subgraph "MODULE INTEGRATION"
        BB[Module 1: Teacher LLM<br/>ðŸ”´ Text â†’ Embedding] --> A
        CC[Module 2: 3D Cubic Core<br/>ðŸ”µ Embedding â†’ Processed] --> A
        S --> DD[Module 3 Output<br/>ðŸŸ¡ Processed â†’ Text]
    end
    
    %% Advanced Features
    subgraph "ADVANCED CAPABILITIES"
        EE[Configuration Validation<br/>ðŸ“‹ Schema checking] --> B
        FF[Fallback Strategies<br/>ðŸ”„ Error recovery] --> F
        GG[Multiple LLM Support<br/>ðŸ§  Various encoders] --> H
        HH[Cache Management<br/>ðŸ—„ï¸ LRU + Analytics] --> E
    end
    
    %% Style definitions
    classDef productionReady fill:#4CAF50,stroke:#2E7D32,stroke-width:3px,color:white
    classDef coreFunction fill:#2196F3,stroke:#1565C0,stroke-width:2px,color:white
    classDef monitoring fill:#FF9800,stroke:#E65100,stroke-width:2px,color:white
    classDef integration fill:#9C27B0,stroke:#6A1B9A,stroke-width:2px,color:white
    classDef advanced fill:#607D8B,stroke:#37474F,stroke-width:2px,color:white
    
    %% Apply styles
    class C,S productionReady
    class H,I,J,P,Q,R coreFunction
    class G,U,V,W,X monitoring
    class BB,CC,DD integration
    class EE,FF,GG,HH advanced 