# Embedding Loader Module

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (Phase 2)  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** torch, numpy, gensim (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üìù –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (—ç–º–±–µ–¥–∏–Ω–≥–æ–≤) —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ 3D –∫–ª–µ—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–≥–æ—Ñ–æ—Ä–º–∞—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: Word2Vec (.bin, .txt), GloVe (.txt), BERT (.pt, .pkl)
- **–£–º–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–µ–∑–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: Seamless –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å core/lattice_3d –º–æ–¥—É–ª–µ–º
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ (>100MB)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from data.embedding_loader import EmbeddingLoader

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑—á–∏–∫–∞
loader = EmbeddingLoader(cache_dir="./data/cache/")

# –ó–∞–≥—Ä—É–∑–∫–∞ Word2Vec —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
embeddings = loader.load_embeddings(
    path="./data/embeddings/word2vec.bin",
    format_type="word2vec",
    preprocess=True
)

print(f"–ó–∞–≥—Ä—É–∂–µ–Ω—ã —ç–º–±–µ–¥–∏–Ω–≥–∏: {embeddings.shape}")
print(f"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: {loader.get_supported_formats()}")
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from data.embedding_loader import EmbeddingLoader, EmbeddingPreprocessor

# –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
loader = EmbeddingLoader()
preprocessor = EmbeddingPreprocessor()

# –ó–∞–≥—Ä—É–∑–∫–∞ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
raw_embeddings = loader.load_embeddings(
    path="./data/embeddings/glove.txt",
    format_type="glove",
    preprocess=False
)

# –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞
processed_embeddings = preprocessor.preprocess(
    raw_embeddings,
    normalize=True,
    center=True,
    clip_outliers=True,
    outlier_std=2.5
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
stats = preprocessor.get_statistics()
print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏: {stats}")
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
data/embedding_loader/
‚îú‚îÄ‚îÄ __init__.py              # –≠–∫—Å–ø–æ—Ä—Ç—ã –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ embedding_loader.py      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å EmbeddingLoader
‚îú‚îÄ‚îÄ format_handlers.py       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ preprocessing.py         # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ embedding_config.yaml # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ plan.md                 # –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ meta.md                 # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ errors.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ diagram.mmd             # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
‚îî‚îÄ‚îÄ examples.md             # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `config/embedding_config.yaml`:

```yaml
cache:
  cache_dir: "./data/cache/"
  max_cache_size: "2GB"

preprocessing:
  default:
    normalize: true
    center: true
    clip_outliers: false
```

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 3D Lattice

```python
from core.lattice_3d import Lattice3D
from data.embedding_loader import EmbeddingLoader

# –ó–∞–≥—Ä—É–∑–∫–∞ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤
loader = EmbeddingLoader()
embeddings = loader.load_embeddings("path/to/embeddings.txt", "glove")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—à–µ—Ç–∫–∏
lattice = Lattice3D(width=10, height=10, depth=10)

# –ü–æ–¥–∞—á–∞ —ç–º–±–µ–¥–∏–Ω–≥–æ–≤ –Ω–∞ –≤—Ö–æ–¥–Ω—É—é –≥—Ä–∞–Ω—å
lattice.set_input_face(embeddings[:100])  # –ü–µ—Ä–≤—ã–µ 100 –≤–µ–∫—Ç–æ—Ä–æ–≤

# –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏
output = lattice.propagate()
```

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- PyTorch 1.9+
- NumPy 1.21+
- gensim 4.2+ (–¥–ª—è Word2Vec .bin —Ñ–∞–π–ª–æ–≤)

### –ü–∞–º—è—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ú–∏–Ω–∏–º—É–º**: 4GB RAM –¥–ª—è —Ñ–∞–π–ª–æ–≤ –¥–æ 100MB
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: 8GB RAM –¥–ª—è —Ñ–∞–π–ª–æ–≤ –¥–æ 1GB
- **–ö—ç—à**: –¢—Ä–µ–±—É–µ—Ç –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ~2x –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —ç–º–±–µ–¥–∏–Ω–≥–∞—Ö
info = loader.get_embedding_info(embeddings)
print(f"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: {info}")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
stats = loader.preprocessor.get_statistics()
print(f"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {stats}")

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
loader.clear_cache()
```

## üö® –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- Gensim —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö Word2Vec —Ñ–∞–π–ª–æ–≤
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç—å—é
- BERT embeddings –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –º–æ–¥–µ–ª–∏

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

- **core/lattice_3d**: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–æ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- **data/tokenizer**: –°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–µ–π
- **data/data_visualization**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —ç–º–±–µ–¥–∏–Ω–≥–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫:

- `errors.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è
- `examples.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –õ–æ–≥ —Ñ–∞–π–ª—ã –≤ `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
